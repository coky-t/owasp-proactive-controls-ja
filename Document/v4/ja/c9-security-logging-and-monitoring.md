---

layout: col-document
tags: OWASP Top Ten Proactive Controls 2024, C9, Implement Security Logging and Monitoring
document: OWASP Top Ten Proactive Controls 2024
order: 413

---

# C9: セキュリティログ記録とモニタリングを実装する (Implement Security Logging and Monitoring)

## 説明

ログ記録はほとんどの開発者がデバッグや診断の目的ですでに使用している概念です。セキュリティログ記録は同様に基本的な概念であり、アプリケーションの実行時操作の中でのセキュリティ情報をログ記録します。モニタリングはさまざまな形式の自動化を使用して、アプリケーションとセキュリティのログをライブでレビューすることです。同じツールとパターンを運用、デバッグ、セキュリティの目的に使用できます。

### セキュリティログ記録の利点

セキュリティログ記録は以下に使用できます。
1. 侵入検知システムへの供給
2. フォレンジック分析と調査
3. 規制遵守要件の確認

### 侵入検知と対応のためのログ記録

ログ記録を使用して、ユーザーが悪意を持って行動していることを示すアクティビティを特定します。ログ記録する潜在的に悪意のあるアクティビティには以下があります。
- 期待した数値範囲外の送信データ。
- 変更不可データ (選択リスト、チェックボックス、その他の限定された入力コンポーネント) への変更を伴う送信データ。
- サーバー側のアクセス制御ルールに違反するリクエスト。
- 現実的な検知ポイントのより包括的なリストは [こちら](https://cheatsheetseries.owasp.org/cheatsheets/Application_Logging_Vocabulary_Cheat_Sheet.html) にあります。
アプリケーションがそのようなアクティビティに遭遇した場合、アプリケーションは少なくともそのアクティビティをログ記録し、重大度の高い問題としてマークする必要があります。理想的には、アプリケーションは、たとえばユーザーのセッションを無効にしたり、ユーザーのアカウントをロックするなど、特定した攻撃の可能性に対応すべきでもあります。対応メカニズムにより、ソフトウェアは特定した攻撃の可能性にリアルタイムで反応できます。

### 安全なログ記録設計

ログ記録ソリューションは安全な方法で構築および管理しなければなりません。安全なログ記録設計には以下を含むことがあります。
- 期待した文字のみを許可したり、ターゲットに基づいて入力をエンコードして、[ログインジェクション](https://www.owasp.org/index.php/Log_Injection) 攻撃を防ぎます。お勧めのアプローチはログ記録ソリューションがデータを削除する代わりに入力エスケープを実行することです。そうしないと、ログ記録ソリューションはのちの分析に必要なデータを破棄するかもしれません。
- 機密情報をログ記録してはいけません。たとえば、パスワード、セッション ID、クレジットカード、社会保障番号をログ記録しないでください。
- ログの完全性を保護します。攻撃者はログを改竄しようとするかもしれません。そのため、ログファイルのパーミッションとログ変更の監査を検討する必要があります。
- 分散システムから一元化した安全なログ記録サービスにログを転送します。これにより、一つのノードが侵害されても、ログデータを失うことはなくなります。また、集中監視や自動監視も可能になります。

## 実装

以下はセキュリティログ記録実装のベストプラクティスのリストです。
- 組織のシステム内およびシステム間で共通のログ記録フォーマットとアプローチに従います。共通のログ記録フレームワークの例としては Apache Logging Services があり、Java, PHP, .NET, C++ アプリケーション間で一貫したログ記録を提供するのに役立ちます。
- ログ記録は多すぎても少なすぎてもいけません。たとえば、タイムスタンプと、ソース IP や ユーザー ID などの識別情報は必ずログ記録するようにしますが、特別な注意を払わない限り、プライベートデータ (ユーザー名など) や機密データ (業務データなど) をログ記録しないように注意してください。
- ノード間の時刻同期に注意を払い、タイムスタンプが一貫していることを確保します。

## 防止される脆弱性

- ログインメカニズムに対するブルートフォース攻撃

## 参考情報

- [Logging Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html)
- [OWASP Logging Guide](https://owasp.org/www-pdf-archive/OWASP_Logging_Guide.pdf)

## ツール
